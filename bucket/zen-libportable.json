{
    "version": "1.0.2-b.1",
    "description": "Experience tranquillity while browsing the web without people tracking you (libportable patched).",
    "homepage": "https://zen-browser.app/",
    "license": "MPL-2.0",
    "notes": [
        "This program installation is an experiment. I looks like libportable can be used absent of patching the source code. I have yet to test full functionality of this method though.",
        "",
        "To run Zen Browser know: libportable's setdll64.exe writes the current PATH in mozglue.dll and editing it directly fails to work. Therefore a new mozglue.dll must patched every time if the path is different. I made a script that automates this behavior:",
        "",
        "zen.ps1 [...args]",
        ""
    ],
    "architecture": {
        "64bit": {
            "url": "https://github.com/zen-browser/desktop/releases/download/1.0.2-b.1/zen.win-arm64.zip",
            "hash": "56D61E7B6079D2F43FC8C267AD7F28C55DCAC102499E3BE86631336060C80DEB"
        }
    },
    "extract_dir": "zen.win-arm64\\zen",
    "depends": "hoilc_scoop-lemon/libportable",
    "pre_install": [
        "if (!(installed 'libportable' $global))",
        "  { error 'Please install `libportable` first.' ; exit }",
        "(Get-Content -path \"$(appdir libportable $global)\\current\\portable(example).ini\" -Raw) -replace 'Update=1','Update=0' | Set-Content -Path \"$dir\\portable.ini\"",
        "  Copy-Item \"$dir\\mozglue.dll\" \"$dir\\mozglue.dll.bck\"",
        "  Copy-Item \"$(appdir libportable $global)\\current\\portable64.dll\" \"$dir\\portable64.dll.bck\"",
        "  Write-Output '",
        "$DIR_ZEN = \"$env:SCOOP\\apps\\zen-libportable\\current\"",
        "if ( Select-String -SimpleMatch $env:USERPROFILE $DIR_ZEN\\mozglue.dll ) {",
        "  . $DIR_ZEN\\zen.exe }",
        "else {",
        "  Copy-Item -Force $DIR_ZEN\\mozglue.dll.bck    $DIR_ZEN\\mozglue.dll",
        "  Copy-Item -Force $DIR_ZEN\\portable64.dll.bck $DIR_ZEN\\portable64.dll",
        "  setdll64.exe  /d:$DIR_ZEN\\portable64.dll     $DIR_ZEN\\mozglue.dll",
        "  . $DIR_ZEN\\zen.exe }",
        "  ' | Out-File \"$dir\\zen.ps1\""
    ],
    "post_install": [
        "zen.ps1 -CreateProfile \"Scoop-Opt $persist_dir\\profile\""
    ],
    "bin": "zen.ps1",
    // "persist": [
    //     "portable.ini",
    //     "Profiles",
    //     "Plugins"
    // ],
    "checkver": {
        "url": "https://api.github.com/repos/zen-browser/desktop/releases?per_page=1",
        "jsonpath": "$[0].tag_name"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/zen-browser/desktop/releases/download/$version/zen.win-arm64.zip"
            }
        }
    }
}
